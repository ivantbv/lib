(()=>{"use strict";document.querySelector(".form-container");const e=document.querySelectorAll('input[name="read"]');let t=0;class o{constructor(o,n,a,c,d,l,s){this.title=o,this.author=n,this.pages=a,this.read=c,e.forEach((e=>{e.checked&&(c=e.value)})),this.link=d,this.image=l,this.id=++t}}let n=[];const a=document.querySelector("#title"),c=document.querySelector("#author"),d=document.querySelector("#pages"),l=document.querySelector("#link"),s=document.querySelector("#picture");let r;const i=document.querySelector(".append-book"),u=()=>{localStorage.setItem("myLibrary",JSON.stringify(n))},m=e=>{const t=document.createElement("div");t.classList.add("book-card");const o=document.createElement("div");o.classList.add("book-title");const a=document.createElement("div");a.classList.add("book-author");const c=document.createElement("div");c.classList.add("book-pages");const d=document.createElement("a");d.classList.add("book-link");const l=document.createElement("img");l.classList.add("book-pic");const s=document.createElement("div");s.classList.add("book-read");const r=document.createElement("button");r.classList.add("delete-book","flex"),r.textContent="X";const m=document.createElement("button");if(m.classList.add("read-button"),m.textContent="Read Status",o.textContent=e.title,a.textContent=e.author,c.textContent=e.pages,s.textContent=e.read,d.href=e.link,d.textContent="Read this book",l.src=e.image,console.log(l.getAttribute("src"),e.image,"book src"),""===l.getAttribute("src")){l.src="/dist/images/NotAvailable.jpeg";const e=document.createElement("input"),o=document.createElement("a");o.href="#",o.textContent="Select an image",e.type="file",e.accept="image/*",e.style.display="none",t.appendChild(e),t.appendChild(o),o.addEventListener("click",(function(t){e&&e.click(),t.preventDefault()}),!1),e.addEventListener("change",(function(){for(let e=0;e<this.files.length;e++)l.src=URL.createObjectURL(this.files[e]),l.onload=function(){URL.revokeObjectURL(this.src)},t.appendChild(l)}),!1)}l.alt="Book's image",u(),r.addEventListener("click",(t=>{n.splice(n.indexOf(e),1),p(n),u()})),m.addEventListener("click",(t=>{"Read"===e.read?e.read="Not read":"Not read"===e.read&&(e.read="Read"),p(n),u()})),t.appendChild(o),"by "!==e.author&&t.appendChild(a)," pages"!==e.pages&&t.appendChild(c),t.appendChild(s),e.link&&t.appendChild(d),t.appendChild(l),t.appendChild(r),t.appendChild(m),i.appendChild(t)};function p(e){const t=document.querySelector(".append-book"),o=document.querySelectorAll(".book-card");o.forEach((e=>t.removeChild(e))),console.log(o,"from createBook func");for(let t=0;t<e.length;t++)m(e[t])}(()=>{if(localStorage.myLibrary){const e=JSON.parse(localStorage.getItem("myLibrary"));n=e,p(n)}else p(n)})();const h=document.querySelector(".searchBar"),y=document.querySelector("#book-name"),k=(document.querySelector("#book-author"),document.querySelectorAll('input[name="filter-search"]')),g=new class{constructor(){this.modal=document.getElementById("myModal"),this.modalBtn=document.getElementById("myBtn"),this.modalSpan=document.getElementsByClassName("close")[0]}openModal(){this.modalBtn.addEventListener("click",(()=>{this.modal.style.display="block"})),this.modalSpan.addEventListener("click",(()=>{this.modal.style.display="none"})),window.addEventListener("click",(e=>{e.target==this.modal&&(this.modal.style.display="none")}))}closeModal(){this.modal.style.display="none"}};g.openModal();const b=document.querySelector(".add-book");document.querySelector("#title").onkeyup=function(){document.querySelector(".add-book").disabled=""===document.querySelector("#title").value},b.addEventListener("click",(()=>{(()=>{for(const t of e)t.checked&&(r=t.value);const t=new o(`${a.value}`,`by ${c.value}`,`${d.value} pages`,`${r}`,`${l.value}`,`${s.value}`);n.push(t),console.log(t.id,n,"from add book to libr func")})(),p(n),g.closeModal()})),k.forEach((e=>e.addEventListener("change",(e=>{h.value="",p(n)})))),h.addEventListener("keyup",(e=>{const t=e.target.value.toLowerCase();p(n.filter((e=>y.checked?e.title.toLowerCase().includes(t):e.author.toLowerCase().includes(t))))}))})();